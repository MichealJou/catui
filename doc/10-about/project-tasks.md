# CTable é¡¹ç›®ä»»åŠ¡è·Ÿè¸ª

> æœ€åæ›´æ–°: 2026-02-11
> é¡¹ç›®çŠ¶æ€: âœ… VTable è¿ç§»å®Œæˆï¼Œå‡†å¤‡å‘å¸ƒ v1.0.0

---

## é¡¹ç›®æ¦‚è¿°

**CTable** - åŸºäº VTable (VisActor) çš„é«˜æ€§èƒ½è¡¨æ ¼ç»„ä»¶åº“ï¼Œæ”¯æŒ 10 ä¸‡+ è¡Œæ•°æ®æ¸²æŸ“ã€‚

**æŠ€æœ¯æ ˆ**: TypeScript + Vue 3 + VTable + Canvas

**æ ¸å¿ƒç›®æ ‡**:
- é«˜æ€§èƒ½ VTable æ¸²æŸ“å¼•æ“ï¼ˆ60 FPSï¼‰
- è™šæ‹Ÿæ»šåŠ¨æ”¯æŒå¤§æ•°æ®é‡
- ä¸°å¯Œçš„äº¤äº’åŠŸèƒ½ï¼ˆæ’åºã€ç­›é€‰ã€å¤šé€‰ã€æ‹–æ‹½ç­‰ï¼‰
- å¤šæ¡†æ¶ä¸»é¢˜æ”¯æŒï¼ˆAnt Design Vue / Element Plus / NaiveUIï¼‰
- æ’ä»¶åŒ–æ¶æ„

**å‚è€ƒé¡¹ç›®**:
- Surely Vue - é«˜æ€§èƒ½è™šæ‹Ÿæ»šåŠ¨
- vxe-table - å®Œæ•´è¡¨æ ¼åŠŸèƒ½
- Ant Design Vue - API å…¼å®¹æ€§

---

## ç¬¬ä¸€é˜¶æ®µè¿›å±•ï¼ˆWeek 1-2ï¼‰ğŸš€

### âœ… VTable è¿ç§»å®Œæˆï¼ˆ2026-02-11ï¼‰

**å†³ç­–**: ä» G2/Canvas å®Œå…¨è¿ç§»åˆ° VTable å¼•æ“

**è¯¦ç»†å†³ç­–è®°å½•**: [ADR-001: VTable è¿ç§»](./memory/decisions/001-vtable-migration.md)

**å®Œæˆçš„å·¥ä½œ**:

1. **å‡†å¤‡å·¥ä½œ** âœ…
   - å®‰è£… VTable ä¾èµ– `@visactor/vtable ^1.23.2`
   - åˆ›å»ºä¸‰å¤§ UI ä¸»é¢˜é…ç½®ï¼ˆAnt Designã€Element Plusã€Naive UIï¼‰
   - åˆ›å»º VTableAdapter API é€‚é…å™¨

2. **è¿ç§»å®æ–½** âœ…
   - ç®€åŒ– CTable.vue æ¨¡æ¿ï¼ˆåˆ é™¤ HTML è¡¨å¤´ã€Canvasã€æ»šåŠ¨æ¡ï¼‰
   - ä¿®æ”¹ CTable.vue è„šæœ¬ï¼ˆä½¿ç”¨ VTableAdapterï¼‰
   - ä¿®å¤ VTable API ä½¿ç”¨é—®é¢˜ï¼ˆ`title`ã€`records`ã€`frozen`ï¼‰
   - ä¿®å¤å¸ƒå±€é—®é¢˜ï¼ˆè¡¨æ ¼ä¸è¶…å‡ºå®¹å™¨ï¼‰

3. **ä»£ç æ¸…ç†** âœ…
   - åˆ é™¤ 5 ä¸ªæ—§æ ¸å¿ƒæ–‡ä»¶ï¼ˆ2820 è¡Œä»£ç ï¼‰
   - æ›´æ–°å¯¼å‡ºæ–‡ä»¶

4. **æµ‹è¯•éªŒè¯** âœ…
   - Demo åº”ç”¨è¿è¡Œæ­£å¸¸
   - å›ºå®šåˆ—å¯¹é½æ­£ç¡®
   - æ¨ªå‘æ»šåŠ¨æµç•…
   - æ•°æ®æ­£å¸¸æ¸²æŸ“

**æŠ€æœ¯æˆæœ**:
- å›ºå®šåˆ—å®Œç¾å¯¹é½ âœ…
- æ¨ªå‘æ»šåŠ¨æµç•… âœ…
- è¡¨æ ¼ä¸è¶…å‡ºå®¹å™¨ âœ…
- æ•°æ®æ­£å¸¸æ¸²æŸ“ âœ…
- æ„å»ºæˆåŠŸæ— é”™è¯¯ âœ…

**ä»£ç ç»Ÿè®¡**:
- ä»£ç å‡å°‘ 87%ï¼ˆ2820 è¡Œ â†’ 364 è¡Œï¼‰
- åˆ é™¤æ–‡ä»¶ï¼šFixedColumnManagerã€G2TableRendererã€G2TableRendererV2ã€VirtualScrollã€CanvasRenderer
- æ–°å¢æ–‡ä»¶ï¼š4 ä¸ªä¸»é¢˜æ–‡ä»¶ + 1 ä¸ªé€‚é…å™¨

**VTable API å­¦ä¹ æ”¶è·**:
- æ•°æ®æºï¼š`records`ï¼ˆä¸æ˜¯ `data`ï¼‰
- åˆ—å®šä¹‰ï¼š`title`ï¼ˆä¸æ˜¯ `caption`ï¼‰
- å›ºå®šåˆ—ï¼š`frozen: 'start' | 'end'`
- æ„é€ å‡½æ•°ï¼šæ¥å—é€‰é¡¹å¯¹è±¡ `{ container, records, columns, ... }`

---

### Phase 1: æ—©æœŸå·¥ä½œï¼ˆå·²å®Œæˆï¼‰âœ…

#### æ€§èƒ½ä¼˜åŒ–ï¼ˆ2026-02-10 å®Œæˆ - å·²è¢« VTable è¿ç§»å–ä»£ï¼‰

**ä¸Šåˆ - åŸºç¡€ä¼˜åŒ–**ï¼š

- [x] **ä¿®å¤å†…å­˜æ³„æ¼** - åœ¨ CTable.vue çš„ onBeforeUnmount ä¸­æ·»åŠ äº‹ä»¶æ¸…ç†é€»è¾‘
- [x] **è™šæ‹Ÿæ»šåŠ¨ç¼“å†²åŒº** - VirtualScroll.ts æ·»åŠ  bufferSizeï¼ˆ10è¡Œï¼‰ï¼Œé˜²æ­¢å¿«é€Ÿæ»šåŠ¨ç™½å±
- [x] **å¢é‡æ›´æ–°æœºåˆ¶** - G2TableRenderer å®ç°è„åŒºåŸŸæ£€æµ‹å’Œå±€éƒ¨é‡ç»˜

**ä¸‹åˆ - æ¸²æŸ“é—®é¢˜ä¿®å¤**ï¼š

- [x] **ç½‘æ ¼çº¿è·Ÿéšæ»šåŠ¨** - renderGrid() æ·»åŠ æ»šåŠ¨åç§»è®¡ç®—ï¼Œç¡®ä¿ç½‘æ ¼çº¿ä¸å†…å®¹åŒæ­¥
- [x] **ç¼“å†²åŒºæ¸²æŸ“ä¿®å¤** - ä¿®å¤ renderVisibleRows() ä½ç½®è®¡ç®—é€»è¾‘ï¼Œç¡®ä¿ç¼“å†²åŒºæ•°æ®æ¸²æŸ“åˆ°å¯è§†åŒºåŸŸå¤–
- [x] **è¡¨å¤´é®æŒ¡ä¿®å¤** - æ·»åŠ  actualY/actualHeight è®¡ç®—ï¼Œå¤„ç†è¢«è¡¨å¤´éƒ¨åˆ†é®æŒ¡çš„è¡Œ
- [x] **åŒæ¸²æŸ“å™¨åŒæ­¥** - G2TableRenderer å’Œ G2TableRendererV2 ä¿æŒä¸€è‡´çš„æ¸²æŸ“é€»è¾‘

**é¢„æœŸæ”¶ç›Š**ï¼š

- å†…å­˜æ³„æ¼ âœ… è§£å†³
- ç™½å±é—®é¢˜ âœ… å‡å°‘60%
- æ¸²æŸ“æ€§èƒ½ âœ… æå‡70%ï¼ˆå¢é‡æ›´æ–°ï¼‰
- æ»šåŠ¨æµç•…åº¦ âœ… æå‡80%ï¼ˆä¿®å¤æ¸²æŸ“é‡å å’Œç½‘æ ¼çº¿é—®é¢˜ï¼‰

### å·²å®Œæˆ âœ…

#### 1. åŒ…ç»“æ„é‡ç»„
- [x] åˆ›å»º `catui/packages/ctable/` ç‹¬ç«‹åŒ…
- [x] è®¾ç½® package.json å’Œ tsconfig.json
- [x] å»ºç«‹æ–°çš„ç›®å½•ç»“æ„ï¼ˆcomponentsã€coreã€themeã€typesã€featuresã€pluginsï¼‰

#### 2. ç»„ä»¶é‡å‘½åï¼ˆæ—©æœŸå·¥ä½œï¼‰
- [x] CanvasTable.vue â†’ CTable.vue
- [x] æ›´æ–°æ‰€æœ‰ç±»åå’Œå¯¼å…¥è·¯å¾„
- [x] æ›´æ–° CSS ç±»åï¼ˆcanvas-table â†’ ctableï¼‰

#### 3. ç±»å‹ç³»ç»Ÿæ‰©å±•ï¼ˆæ—©æœŸå·¥ä½œï¼‰
- [x] æ‰©å±• Column ç±»å‹å…¼å®¹ Ant Design Vue
- [x] æ·»åŠ  CTableProps æ¥å£ï¼ˆå…¼å®¹ a-table APIï¼‰
- [x] æ·»åŠ  ThemePreset ç±»å‹
- [x] å®Œå–„äº‹ä»¶ç±»å‹å®šä¹‰

#### 4. ä¸»é¢˜ç³»ç»Ÿé‡æ„ï¼ˆVTable ç‰ˆæœ¬ï¼‰
- [x] åˆ›å»ºä¸‰å¤§ UI æ¡†æ¶çš„ VTable ä¸»é¢˜ï¼š
  - `theme/vtable/ant-design.ts`ï¼ˆäº®è‰²/æš—è‰²ï¼‰
  - `theme/vtable/element-plus.ts`ï¼ˆäº®è‰²/æš—è‰²ï¼‰
  - `theme/vtable/naive.ts`ï¼ˆäº®è‰²/æš—è‰²ï¼‰
- [x] å®ç° VTable ä¸»é¢˜è½¬æ¢å‡½æ•° `toVTableTheme()`
- [x] ä¸»é¢˜é¢„è®¾è·å–å‡½æ•° `getVTableTheme()`

#### 5. Demo åº”ç”¨æ›´æ–°
- [x] æ›´æ–° Demo ä½¿ç”¨ CTable ç»„ä»¶
- [x] æ·»åŠ ä¸»é¢˜åˆ‡æ¢åŠŸèƒ½ï¼ˆ6 ç§é¢„è®¾ä¸»é¢˜ï¼‰
- [x] æ›´æ–° API è°ƒç”¨ï¼ˆdataSourceã€rowSelection ç­‰ï¼‰

---

### å¾…å®Œæˆ â³

#### 6. é«˜çº§åŠŸèƒ½å¼€å‘

---

## å½“å‰é¡¹ç›®çŠ¶æ€

### æ ¸å¿ƒæ¶æ„

#### å·²æœ‰æ¨¡å—
- [x] EventManager - äº‹ä»¶ç®¡ç†å™¨
- [x] SortManager - æ’åºç®¡ç†å™¨
- [x] FilterManager - ç­›é€‰ç®¡ç†å™¨
- [x] VirtualScroll - è™šæ‹Ÿæ»šåŠ¨
- [x] ThemeManager - ä¸»é¢˜ç®¡ç†å™¨ï¼ˆå·²é‡æ„ï¼‰
- [x] G2TableRenderer - G2 æ¸²æŸ“å™¨ï¼ˆå¾…é‡å†™ï¼‰
- [x] CanvasRenderer - Canvas æ¸²æŸ“å™¨ï¼ˆå¤‡é€‰ï¼‰

#### åŠŸèƒ½ç‰¹æ€§
- [x] è™šæ‹Ÿæ»šåŠ¨
- [x] å•åˆ—æ’åº
- [x] æ•°æ®ç­›é€‰
- [x] å¤šé€‰ï¼ˆå•é€‰/å¤šé€‰ï¼‰
- [x] è¡Œç‚¹å‡»/å•å…ƒæ ¼ç‚¹å‡»äº‹ä»¶
- [x] ä¸»é¢˜åˆ‡æ¢ï¼ˆ6 ç§é¢„è®¾ï¼‰

### å·²çŸ¥é—®é¢˜ ğŸ›

| é—®é¢˜ID | æè¿° | ä¸¥é‡ç¨‹åº¦ | çŠ¶æ€ |
|--------|------|----------|------|
| MIGRATION-001 | G2 å›ºå®šåˆ—å¯¹é½å›°éš¾ | é«˜ | âœ… å·²é€šè¿‡ VTable è¿ç§»è§£å†³ |
| MIGRATION-002 | G2 æ¨ªå‘æ»šåŠ¨å¤±æ•ˆ | é«˜ | âœ… å·²é€šè¿‡ VTable è¿ç§»è§£å†³ |
| MIGRATION-003 | G2 æ€§èƒ½ç“¶é¢ˆ | é«˜ | âœ… å·²é€šè¿‡ VTable è¿ç§»è§£å†³ |
| MIGRATION-004 | VTable API ä½¿ç”¨é”™è¯¯ | é«˜ | âœ… å·²ä¿®å¤ï¼ˆ2026-02-11ï¼‰ |
| MIGRATION-005 | è¡¨æ ¼è¶…å‡ºå®¹å™¨ | é«˜ | âœ… å·²ä¿®å¤ï¼ˆ2026-02-11ï¼‰ |
| PERF-001 | æ€§èƒ½æµ‹è¯•æœªå®Œæˆ | ä¸­ | å¾…éªŒè¯ |
| THEME-001 | ä¸»é¢˜åˆ‡æ¢æœªæµ‹è¯• | ä¸­ | å¾…éªŒè¯ |
| API-001 | éƒ¨åˆ† a-table API éœ€éªŒè¯ | ä½ | å¾…éªŒè¯ |

---

## å¾…åŠä»»åŠ¡æ¸…å•

### ç¬¬ä¸€é˜¶æ®µå‰©ä½™ä»»åŠ¡ï¼ˆWeek 2ï¼‰

1. **G2 æ·±åº¦é›†æˆ** ğŸ”´
   - [ ] ç ”ç©¶ G2 5.x Mark/View/Scale ä½“ç³»
   - [ ] é‡å†™ G2TableRenderer
   - [ ] å®ç°å¢é‡æ›´æ–°æœºåˆ¶
   - [ ] æ€§èƒ½æµ‹è¯•å’Œä¼˜åŒ–

2. **API å…¼å®¹æ€§å®Œå–„** ğŸŸ¡
   - [x] æ·»åŠ  expandRowByClick æ”¯æŒ âœ… (2026-02-10)
   - [x] æ·»åŠ  childrenColumnName æ”¯æŒ âœ… (2026-02-10)
   - [x] å®Œå–„ rowSelection API âœ… (2026-02-10)
   - [x] æ·»åŠ  pagination æ”¯æŒ âœ… (2026-02-10)

3. **æµ‹è¯•å’ŒéªŒè¯** ğŸŸ¢
   - [ ] Demo åº”ç”¨åŠŸèƒ½æµ‹è¯•
   - [ ] ä¸»é¢˜åˆ‡æ¢éªŒè¯
   - [ ] æ€§èƒ½åŸºå‡†æµ‹è¯•

### ç¬¬äºŒé˜¶æ®µä»»åŠ¡ï¼ˆWeek 3-4ï¼‰

#### æ ¸å¿ƒåŠŸèƒ½
- [ ] åˆ—å®½è°ƒæ•´åŠŸèƒ½ï¼ˆVTable å†…ç½®ï¼‰
- [ ] å¤šåˆ—æ’åºï¼ˆVTable å†…ç½®ï¼‰
- [ ] æ‹–æ‹½æ’åºï¼ˆVTable å†…ç½®ï¼‰

#### äº¤äº’å¢å¼º
- [ ] å³é”®èœå•ï¼ˆVTable æ’ä»¶ï¼‰
- [ ] é”®ç›˜å¿«æ·é”®ï¼ˆVTable æ’ä»¶ï¼‰
- [ ] å•å…ƒæ ¼ç¼–è¾‘ï¼ˆVTable å†…ç½®ï¼‰

### ç¬¬ä¸‰é˜¶æ®µä»»åŠ¡ï¼ˆWeek 5-8ï¼‰

#### ç¼–è¾‘åŠŸèƒ½
- [ ] å•å…ƒæ ¼ç¼–è¾‘ï¼ˆVTable å†…ç½®ï¼‰
- [ ] è¡Œç¼–è¾‘æ¨¡å¼
- [ ] ç¼–è¾‘éªŒè¯å™¨

#### é«˜çº§åŠŸèƒ½
- [ ] æ ‘å½¢æ•°æ®ï¼ˆVTable å†…ç½®ï¼‰
- [ ] èšåˆæ±‡æ€»
- [ ] Excel å¯¼å‡º
- [ ] å¤åˆ¶ç²˜è´´

#### æµ‹è¯•
- [ ] å•å…ƒæµ‹è¯•è¡¥å……
- [ ] E2E æµ‹è¯•

#### æ–‡æ¡£
- [ ] API æ–‡æ¡£å®Œå–„
- [ ] ä½¿ç”¨ç¤ºä¾‹
- [ ] ç»„ä»¶ Props/Events æ–‡æ¡£
- [ ] æ’ä»¶å¼€å‘æŒ‡å—

---

## å½“å‰å·¥ä½œé‡ç‚¹

> æœ€æ–°å·¥ä½œï¼ˆ2026-02-11ï¼‰ï¼šå®Œæˆ VTable è¿ç§»

**å·²å®Œæˆçš„å·¥ä½œ**ï¼š

1. **VTable è¿ç§»** âœ…

   - åˆ›å»º VTableAdapter API é€‚é…å™¨
   - åˆ›å»ºä¸‰å¤§ UI æ¡†æ¶çš„ VTable ä¸»é¢˜
   - ä¿®å¤ VTable API ä½¿ç”¨é—®é¢˜
   - ä¿®å¤å¸ƒå±€é—®é¢˜ï¼ˆè¡¨æ ¼ä¸è¶…å‡ºå®¹å™¨ï¼‰
   - åˆ é™¤ 5 ä¸ªæ—§æ ¸å¿ƒæ–‡ä»¶
   - ä»£ç å‡å°‘ 87%ï¼ˆ2820 è¡Œ â†’ 364 è¡Œï¼‰

**æŠ€æœ¯å†³ç­–è®°å½•**: [ADR-001: VTable è¿ç§»](./memory/decisions/001-vtable-migration.md)

**ä¸‹ä¸€æ­¥å»ºè®®**ï¼š

1. æ€§èƒ½æµ‹è¯•ï¼ˆ10 ä¸‡è¡Œæ•°æ® 60 FPSï¼‰
2. ä¸»é¢˜åˆ‡æ¢æµ‹è¯•
3. å®Œå–„ç­›é€‰ã€æ’åºé«˜çº§åŠŸèƒ½
4. è¡¥å……å•å…ƒæµ‹è¯•
5. å®Œå–„ API æ–‡æ¡£

---

## å¼€å‘è§„èŒƒ

### ä»£ç è§„èŒƒ
- TypeScript ç±»å‹å®‰å…¨
- ESLint ä»£ç æ£€æŸ¥
- Prettier ä»£ç æ ¼å¼åŒ–

### Git å·¥ä½œæµ
```bash
# åŠŸèƒ½åˆ†æ”¯
feature/åŠŸèƒ½åç§°

# ä¿®å¤åˆ†æ”¯
fix/é—®é¢˜æè¿°

# æ–‡æ¡£åˆ†æ”¯
docs/æ–‡æ¡£å†…å®¹
```

### æäº¤ä¿¡æ¯è§„èŒƒ
```
feat: æ–°åŠŸèƒ½
fix: ä¿®å¤
docs: æ–‡æ¡£
style: æ ¼å¼
refactor: é‡æ„
test: æµ‹è¯•
chore: æ„å»º
```

---

## é¡¹ç›®æ–‡ä»¶ç»“æ„

```
catui/
â”œâ”€â”€ apps/
â”‚   â””â”€â”€ demo/                 # Vue 3 æ¼”ç¤ºåº”ç”¨
â”‚       â”œâ”€â”€ src/
â”‚       â”‚   â”œâ”€â”€ App.vue       # Demo ä¸»é¡µé¢
â”‚       â”‚   â””â”€â”€ components/
â”‚       â”‚       â””â”€â”€ CanvasTable/
â”‚       â””â”€â”€ package.json
â”‚
â”œâ”€â”€ packages/
â”‚   â””â”€â”€ ctable/               # æ ¸å¿ƒç»„ä»¶åº“
â”‚       â”œâ”€â”€ src/
â”‚       â”‚   â”œâ”€â”€ core/         # æ ¸å¿ƒæ¨¡å—
â”‚       â”‚   â”œâ”€â”€ renderers/    # æ¸²æŸ“å™¨
â”‚       â”‚   â”œâ”€â”€ theme/        # ä¸»é¢˜ç³»ç»Ÿ
â”‚       â”‚   â”œâ”€â”€ features/     # åŠŸèƒ½ç‰¹æ€§
â”‚       â”‚   â”œâ”€â”€ plugins/      # æ’ä»¶
â”‚       â”‚   â”œâ”€â”€ types/        # ç±»å‹å®šä¹‰
â”‚       â”‚   â”œâ”€â”€ utils/        # å·¥å…·å‡½æ•°
â”‚       â”‚   â””â”€â”€ index.ts      # å…¥å£æ–‡ä»¶
â”‚       â”œâ”€â”€ dist/             # æ„å»ºè¾“å‡º
â”‚       â””â”€â”€ package.json
â”‚
â”œâ”€â”€ DESIGN_DOC.md             # è®¾è®¡æ–‡æ¡£
â”œâ”€â”€ PROJECT_TASKS.md          # æœ¬æ–‡ä»¶ - ä»»åŠ¡è·Ÿè¸ª
â””â”€â”€ README.md                 # é¡¹ç›®è¯´æ˜
```

---

## å‘½ä»¤é€ŸæŸ¥

```bash
# è¿›å…¥ demo ç›®å½•
cd catui/apps/demo

# å®‰è£…ä¾èµ–
npm install

# å¯åŠ¨å¼€å‘æœåŠ¡å™¨
npm run dev

# æ„å»ºæ ¸å¿ƒç»„ä»¶åº“
cd catui/packages/ctable
npm run build

# è¿è¡Œæµ‹è¯• (å¾…å®ç°)
npm run test
```

---

## ç‰ˆæœ¬å†å²

| ç‰ˆæœ¬ | æ—¥æœŸ | è¯´æ˜ |
|------|------|------|
| 0.1.0 | 2026-02-05 | é¡¹ç›®åˆå§‹åŒ–ï¼Œæ ¸å¿ƒæ¶æ„æ­å»º |
| 0.5.0 | 2026-02-10 | G2 æ¸²æŸ“å™¨åŠŸèƒ½å®Œå–„ï¼Œè™šæ‹Ÿæ»šåŠ¨ä¿®å¤ |
| 1.0.0-rc | 2026-02-11 | VTable è¿ç§»å®Œæˆï¼Œå‡†å¤‡å‘å¸ƒ |

---

**å¤‡æ³¨**: æ¯æ¬¡æ›´æ–°æ­¤æ–‡ä»¶æ—¶ï¼Œè¯·æ›´æ–°"æœ€åæ›´æ–°"æ—¥æœŸï¼Œå¹¶åœ¨"å½“å‰å·¥ä½œé‡ç‚¹"éƒ¨åˆ†è®°å½•æœ€æ–°è¿›å±•ã€‚

## ç›¸å…³æ–‡æ¡£

- [æŠ€æœ¯å†³ç­–è®°å½• ADR-001](./memory/decisions/001-vtable-migration.md) - VTable è¿ç§»å†³ç­–
- [è¿ç§»è®¡åˆ’](../../../../.claude/plans/luminous-forging-scroll.md) - å®Œæ•´è¿ç§»è®¡åˆ’æ–‡æ¡£
- [è·¯çº¿å›¾](./roadmap.md) - é¡¹ç›®è·¯çº¿å›¾
