# CatUI 项目宪章

## 核心原则

### I. 组件优先
CatUI 是一个**组件库项目**，所有功能开发围绕可复用的表格组件展开。

- **组件独立** - 每个组件可独立使用、测试和文档
- **类型安全** - TypeScript 严格模式，禁用 `any` 类型
- **性能优先** - 基于虚拟滚动，支持百万级数据
- **渐进增强** - 从基础功能开始，逐步增强

### II. 测试驱动 (NON-NEGOTIABLE)
组件功能开发**必须**遵循 TDD 流程：

1. **先写测试** - 定义组件的期望行为
2. **测试失败** - 运行测试确认失败
3. **实现功能** - 编写代码使测试通过
4. **重构优化** - 测试通过后优化代码结构

**禁止跳过测试直接实现功能。**

### III. 性能标准
CatUI 定位为**高性能表格组件**，必须满足：

- **大数据支持** - 10万+ 数据流畅渲染
- **虚拟滚动** - 只渲染可见区域
- **浅层比较** - 避免深度遍历和 unnecessary 更新
- **内存控制** - 及时清理事件监听器和定时器

### IV. 文档同步
代码变更**必须**同步更新文档：

- **API 变更** → 更新 `packages/ctable/README.md`
- **新功能** → 更新 `doc/01-getting-started/table-guide.md`
- **类型变更** → 更新 TypeScript 类型定义注释

### V. API 优先 (NON-NEGOTIABLE)
开发新功能**必须**先查阅官方 API 文档：

- **查官方文档** - 阅读 @visactor/vtable 官方 API
- **确认已有功能** - 英文文档已有功能直接使用，不重复开发
- **正确用法** - 使用官方推荐的方式配置组件
- **避免臆测** - 不凭经验猜测 API，以文档为准

**禁止不看文档直接写代码。**

### VI. 简单原则
- **避免过度设计** - 不过度抽象，保持代码简单
- **YAGNI** - You Aren't Gonna Need It（不需要的功能不做）
- **渐进式开发** - 小步快跑，频繁验证

---

## 开发工作流

### 1. 需求分析
- 阅读 [WORKFLOW.md](.claude/WORKFLOW.md)
- 查看相关组件/模块的现有实现
- 确认技术栈（Vue 3.3 + TypeScript 5.3）

### 2. API 调研 (NON-NEGOTIABLE)

**必须先查阅官方文档，再写代码：**

- **VTable 官方文档** - <https://visactor.io/vtable/guide/basic_list_table>
- **搜索已有功能** - 使用 Ctrl+F 搜索关键词
- **查看示例代码** - 参考官方示例的正确用法
- **确认 API 参数** - 严格按照文档格式传递参数

**禁止：**

- ❌ 凭经验猜测 API
- ❌ 参考过时的博客或教程
- ❌ 重复开发已有功能

### 2.1 技能文档更新

学习完 API 后**必须**更新技能文档：

- **更新 `.claude/skills/vtable.md`** - 记录学到的 API 和用法
- **添加示例代码** - 常见配置和问题解决方案
- **记录坑点** - 容易出错的地方（如 stripe 需要传 `{}` 而不是 `undefined`）
- **标注待学习** - 列出需要深入了解的功能

**下次开发相同功能时，先查看技能文档。**

### 3. 设计阶段
- 设计组件 API 和类型定义
- 评估性能影响
- 确定实现方案

### 4. 实现阶段

遵循 `WORKFLOW.md` 定义的规范：

- 使用 Composition API + `<script setup>`
- 所有 props 必须有 TypeScript 类型
- 避免使用 `any`，使用 `unknown` 或具体类型

### 5. 测试阶段
- 在 demo 应用中测试组件
- 验证所有功能正常
- 检查控制台无错误或警告
- 性能验证（大数据渲染）

### 6. 代码检查

```bash
# 类型检查
pnpm type-check

# 代码检查
pnpm lint
pnpm lint:fix
```

### 7. 文档更新

- 更新组件使用说明
- 更新 API 变更记录
- 同步到 `doc/` 目录

### 8. 代码审查
- 提交 PR 前自我审查
- 确保遵循代码规范
- 检查类型定义完整性

---

## 质量标准

### 代码质量门槛
- ✅ 通过 TypeScript 类型检查（无 `any`）
- ✅ 通过 ESLint 检查（无警告）
- ✅ 通过 demo 功能测试
- ✅ 无控制台错误或警告

### 性能标准
- ✅ 10万数据初始化 < 1秒
- ✅ 滚动流畅（60fps）
- ✅ 列宽调整响应 < 100ms

### 文档标准
- ✅ 每个公开组件有 README
- ✅ 复杂功能有使用示例
- ✅ API 变更有更新日志

---

**Version**: 1.1.0 | **Ratified**: 2025-02-13 | **Last Amended**: 2025-02-13
