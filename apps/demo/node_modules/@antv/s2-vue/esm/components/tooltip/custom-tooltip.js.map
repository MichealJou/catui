{"version":3,"file":"custom-tooltip.js","sources":["../../../src/components/tooltip/custom-tooltip.ts"],"sourcesContent":["import { BaseTooltip, SpreadSheet, type TooltipShowOptions } from '@antv/s2';\nimport { createVNode, render, type VNodeProps } from 'vue';\nimport TooltipComponent from './index.vue';\nimport type { TooltipRenderProps } from './interface';\n\nexport class CustomTooltip extends BaseTooltip {\n  constructor(spreadsheet: SpreadSheet) {\n    super(spreadsheet);\n  }\n\n  renderContent() {\n    // 配置级 s2.options.tooltip.content = ''\n    const { tooltip } = this.spreadsheet.options;\n    // 方法级 s2.showTooltip({ content: '' })\n    const showOptions = this.options;\n    const cell = this.spreadsheet.getCell(\n      showOptions.event?.target as EventTarget,\n    )!;\n    // 优先级: 方法级 > 配置级, 兼容 content 为空字符串的场景\n    const content = showOptions.content ?? tooltip?.content;\n\n    const tooltipProps: TooltipRenderProps<TooltipShowOptions['content']> = {\n      ...showOptions,\n      cell,\n      content,\n    };\n\n    // 保留 content 通过 props 传递的同时，新增通过 slot 传递。因为 slot 可能是 Component\n    const tooltipVNode = createVNode(\n      TooltipComponent,\n      tooltipProps as VNodeProps,\n      {\n        content: () => content,\n      },\n    );\n\n    // render(null) 确保每一次的 tooltip 内容是最新的\n    render(null, this.container!);\n    render(tooltipVNode, this.container!);\n  }\n\n  destroy() {\n    super.destroy();\n    if (this.container) {\n      render(null, this.container);\n    }\n  }\n}\n"],"names":[],"mappings":";;;;;;;;;;;;;;;;;;;;;;AAKO,MAAM,sBAAsB,YAAY;AAAA,EAC7C,YAAY,aAA0B;AACpC,UAAM,WAAW;AAAA,EACnB;AAAA,EAEA,gBAAgB;;AAEd,UAAM,EAAE,QAAA,IAAY,KAAK,YAAY;AAErC,UAAM,cAAc,KAAK;AACzB,UAAM,OAAO,KAAK,YAAY;AAAA,OAC5B,iBAAY,UAAZ,mBAAmB;AAAA,IAAA;AAGrB,UAAM,WAAU,iBAAY,YAAZ,YAAuB,mCAAS;AAEhD,UAAM,eAAkE,iCACnE,cADmE;AAAA,MAEtE;AAAA,MACA;AAAA,IAAA;AAIF,UAAM,eAAe;AAAA,MACnB;AAAA,MACA;AAAA,MACA;AAAA,QACE,SAAS,MAAM;AAAA,MAAA;AAAA,IACjB;AAIF,WAAO,MAAM,KAAK,SAAU;AAC5B,WAAO,cAAc,KAAK,SAAU;AAAA,EACtC;AAAA,EAEA,UAAU;AACR,UAAM,QAAA;AACN,QAAI,KAAK,WAAW;AAClB,aAAO,MAAM,KAAK,SAAS;AAAA,IAC7B;AAAA,EACF;AACF;"}