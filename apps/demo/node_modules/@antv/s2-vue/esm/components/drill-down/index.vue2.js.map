{"version":3,"file":"index.vue2.js","sources":["../../../src/components/drill-down/index.vue"],"sourcesContent":["<script lang=\"ts\">\nimport { defineComponent, ref } from 'vue';\nimport type { Ref } from 'vue';\nimport {\n  DRILL_DOWN_PRE_CLASS,\n  type BaseDrillDownDataSet,\n  type BaseDrillDownComponentProps,\n} from '@antv/s2';\nimport { Button, Input, Empty, Menu, MenuItem } from 'ant-design-vue';\nimport type { SelectInfo } from 'ant-design-vue/es/menu/src/interface';\nimport { isEmpty } from 'lodash';\nimport type { Key } from 'ant-design-vue/es/_util/type';\nimport type { ChangeEvent } from 'ant-design-vue/es/_util/EventInterface';\nimport LocationIcon from '../../icons/location-icon.vue';\nimport TextIcon from '../../icons/text-icon.vue';\nimport CalendarIcon from '../../icons/calendar-icon.vue';\nimport {\n  initDrillDownEmits,\n  initDrillDownProps,\n} from '../../utils/initPropAndEmits';\n\nexport default defineComponent({\n  name: 'DrillDown',\n  props: initDrillDownProps(),\n  emits: initDrillDownEmits(),\n  methods: {},\n  components: {\n    Button,\n    Input,\n    Empty,\n    Menu,\n    MenuItem,\n    LocationIcon,\n    TextIcon,\n    CalendarIcon,\n  },\n  setup(props) {\n    const {\n      dataSet,\n      disabledFields,\n      getDrillFields,\n      setDrillFields,\n      className,\n    } = props as BaseDrillDownComponentProps;\n    const getOptions = () =>\n      dataSet.map((val: BaseDrillDownDataSet) => {\n        val.disabled = !!(disabledFields && disabledFields.includes(val.value));\n\n        return val;\n      });\n\n    const options: Ref<BaseDrillDownDataSet[]> = ref(getOptions());\n    const selected = ref<Key[]>([]);\n\n    const handleSearch = (e: ChangeEvent) => {\n      const { value } = e.target;\n\n      if (!value) {\n        options.value = [...dataSet];\n      } else {\n        const reg = new RegExp(value, 'gi');\n        const result = dataSet.filter((item) => reg.test(item.name));\n\n        options.value = [...result];\n      }\n    };\n\n    const handleSelect = (value: SelectInfo) => {\n      const key = value?.selectedKeys;\n\n      selected.value = key;\n      if (getDrillFields) {\n        getDrillFields(key as string[]);\n      }\n\n      if (setDrillFields) {\n        setDrillFields(key as string[]);\n      }\n    };\n\n    const handleClear = (e: { stopPropagation: () => void }) => {\n      e.stopPropagation();\n      selected.value = [];\n      if (getDrillFields) {\n        getDrillFields([]);\n      }\n\n      if (setDrillFields) {\n        setDrillFields([]);\n      }\n    };\n\n    return {\n      options,\n      handleSearch,\n      handleSelect,\n      handleClear,\n      className,\n      selected,\n      isEmpty,\n      DRILL_DOWN_PRE_CLASS,\n    };\n  },\n});\n</script>\n\n<template>\n  <div :class=\"[DRILL_DOWN_PRE_CLASS, className]\">\n    <header :class=\"`${DRILL_DOWN_PRE_CLASS}-header`\">\n      <div>{{ title }}</div>\n      <Button type=\"link\" @click=\"handleClear\">\n        {{ clearText }}\n      </Button>\n    </header>\n    <Input\n      :class=\"`${DRILL_DOWN_PRE_CLASS}-search`\"\n      :placeholder=\"searchText\"\n      @change=\"handleSearch\"\n      @pressEnter=\"handleSearch\"\n      :allowClear=\"true\"\n    />\n    <Empty\n      v-if=\"isEmpty(options)\"\n      :imageStyle=\"{ height: '64px' }\"\n      :class=\"`${DRILL_DOWN_PRE_CLASS}-empty`\"\n    />\n    <Menu\n      class=\"`${DRILL_DOWN_PRE_CLASS}-menu`\"\n      v-model:selectedKeys=\"selected\"\n      @select=\"handleSelect\"\n    >\n      <MenuItem\n        v-for=\"option in options\"\n        :key=\"option.value\"\n        :disabled=\"option.disabled\"\n        :class=\"`${DRILL_DOWN_PRE_CLASS}-menu-item`\"\n      >\n        <template #icon>\n          <TextIcon v-if=\"option.type === 'text'\" />\n          <CalendarIcon v-if=\"option.type === 'date'\" />\n          <LocationIcon v-if=\"option.type === 'location'\" />\n        </template>\n        {{ option?.name }}\n      </MenuItem>\n    </Menu>\n  </div>\n</template>\n\n<style lang=\"less\" scoped>\n@import '@antv/s2/esm/shared/styles/drill-down.less';\n</style>\n"],"names":[],"mappings":";;;;;;;;AAqBA,MAAA,YAAe,gBAAgB;AAAA,EAC7B,MAAM;AAAA,EACN,OAAO,mBAAA;AAAA,EACP,OAAO,mBAAA;AAAA,EACP,SAAS,CAAA;AAAA,EACT,YAAY;AAAA,IACV;AAAA,IACA;AAAA,IACA;AAAA,IACA;AAAA,IACA;AAAA,IACA;AAAA,IACA;AAAA,IACA;AAAA,EAAA;AAAA,EAEF,MAAM,OAAO;AACX,UAAM;AAAA,MACJ;AAAA,MACA;AAAA,MACA;AAAA,MACA;AAAA,MACA;AAAA,IAAA,IACE;AACJ,UAAM,aAAa,MACjB,QAAQ,IAAI,CAAC,QAA8B;AACzC,UAAI,WAAW,CAAC,EAAE,kBAAkB,eAAe,SAAS,IAAI,KAAK;AAErE,aAAO;AAAA,IACT,CAAC;AAEH,UAAM,UAAuC,IAAI,YAAY;AAC7D,UAAM,WAAW,IAAW,EAAE;AAE9B,UAAM,eAAe,CAAC,MAAmB;AACvC,YAAM,EAAE,UAAU,EAAE;AAEpB,UAAI,CAAC,OAAO;AACV,gBAAQ,QAAQ,CAAC,GAAG,OAAO;AAAA,MAC7B,OAAO;AACL,cAAM,MAAM,IAAI,OAAO,OAAO,IAAI;AAClC,cAAM,SAAS,QAAQ,OAAO,CAAC,SAAS,IAAI,KAAK,KAAK,IAAI,CAAC;AAE3D,gBAAQ,QAAQ,CAAC,GAAG,MAAM;AAAA,MAC5B;AAAA,IACF;AAEA,UAAM,eAAe,CAAC,UAAsB;AAC1C,YAAM,MAAM,+BAAO;AAEnB,eAAS,QAAQ;AACjB,UAAI,gBAAgB;AAClB,uBAAe,GAAe;AAAA,MAChC;AAEA,UAAI,gBAAgB;AAClB,uBAAe,GAAe;AAAA,MAChC;AAAA,IACF;AAEA,UAAM,cAAc,CAAC,MAAuC;AAC1D,QAAE,gBAAA;AACF,eAAS,QAAQ,CAAA;AACjB,UAAI,gBAAgB;AAClB,uBAAe,CAAA,CAAE;AAAA,MACnB;AAEA,UAAI,gBAAgB;AAClB,uBAAe,CAAA,CAAE;AAAA,MACnB;AAAA,IACF;AAEA,WAAO;AAAA,MACL;AAAA,MACA;AAAA,MACA;AAAA,MACA;AAAA,MACA;AAAA,MACA;AAAA,MACA;AAAA,MACA;AAAA,IAAA;AAAA,EAEJ;AACF,CAAC;"}