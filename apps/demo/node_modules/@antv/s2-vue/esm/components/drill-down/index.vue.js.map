{"version":3,"file":"index.vue.js","sources":["../../../src/components/drill-down/index.vue"],"sourcesContent":["<script lang=\"ts\">\nimport { defineComponent, ref } from 'vue';\nimport type { Ref } from 'vue';\nimport {\n  DRILL_DOWN_PRE_CLASS,\n  type BaseDrillDownDataSet,\n  type BaseDrillDownComponentProps,\n} from '@antv/s2';\nimport { Button, Input, Empty, Menu, MenuItem } from 'ant-design-vue';\nimport type { SelectInfo } from 'ant-design-vue/es/menu/src/interface';\nimport { isEmpty } from 'lodash';\nimport type { Key } from 'ant-design-vue/es/_util/type';\nimport type { ChangeEvent } from 'ant-design-vue/es/_util/EventInterface';\nimport LocationIcon from '../../icons/location-icon.vue';\nimport TextIcon from '../../icons/text-icon.vue';\nimport CalendarIcon from '../../icons/calendar-icon.vue';\nimport {\n  initDrillDownEmits,\n  initDrillDownProps,\n} from '../../utils/initPropAndEmits';\n\nexport default defineComponent({\n  name: 'DrillDown',\n  props: initDrillDownProps(),\n  emits: initDrillDownEmits(),\n  methods: {},\n  components: {\n    Button,\n    Input,\n    Empty,\n    Menu,\n    MenuItem,\n    LocationIcon,\n    TextIcon,\n    CalendarIcon,\n  },\n  setup(props) {\n    const {\n      dataSet,\n      disabledFields,\n      getDrillFields,\n      setDrillFields,\n      className,\n    } = props as BaseDrillDownComponentProps;\n    const getOptions = () =>\n      dataSet.map((val: BaseDrillDownDataSet) => {\n        val.disabled = !!(disabledFields && disabledFields.includes(val.value));\n\n        return val;\n      });\n\n    const options: Ref<BaseDrillDownDataSet[]> = ref(getOptions());\n    const selected = ref<Key[]>([]);\n\n    const handleSearch = (e: ChangeEvent) => {\n      const { value } = e.target;\n\n      if (!value) {\n        options.value = [...dataSet];\n      } else {\n        const reg = new RegExp(value, 'gi');\n        const result = dataSet.filter((item) => reg.test(item.name));\n\n        options.value = [...result];\n      }\n    };\n\n    const handleSelect = (value: SelectInfo) => {\n      const key = value?.selectedKeys;\n\n      selected.value = key;\n      if (getDrillFields) {\n        getDrillFields(key as string[]);\n      }\n\n      if (setDrillFields) {\n        setDrillFields(key as string[]);\n      }\n    };\n\n    const handleClear = (e: { stopPropagation: () => void }) => {\n      e.stopPropagation();\n      selected.value = [];\n      if (getDrillFields) {\n        getDrillFields([]);\n      }\n\n      if (setDrillFields) {\n        setDrillFields([]);\n      }\n    };\n\n    return {\n      options,\n      handleSearch,\n      handleSelect,\n      handleClear,\n      className,\n      selected,\n      isEmpty,\n      DRILL_DOWN_PRE_CLASS,\n    };\n  },\n});\n</script>\n\n<template>\n  <div :class=\"[DRILL_DOWN_PRE_CLASS, className]\">\n    <header :class=\"`${DRILL_DOWN_PRE_CLASS}-header`\">\n      <div>{{ title }}</div>\n      <Button type=\"link\" @click=\"handleClear\">\n        {{ clearText }}\n      </Button>\n    </header>\n    <Input\n      :class=\"`${DRILL_DOWN_PRE_CLASS}-search`\"\n      :placeholder=\"searchText\"\n      @change=\"handleSearch\"\n      @pressEnter=\"handleSearch\"\n      :allowClear=\"true\"\n    />\n    <Empty\n      v-if=\"isEmpty(options)\"\n      :imageStyle=\"{ height: '64px' }\"\n      :class=\"`${DRILL_DOWN_PRE_CLASS}-empty`\"\n    />\n    <Menu\n      class=\"`${DRILL_DOWN_PRE_CLASS}-menu`\"\n      v-model:selectedKeys=\"selected\"\n      @select=\"handleSelect\"\n    >\n      <MenuItem\n        v-for=\"option in options\"\n        :key=\"option.value\"\n        :disabled=\"option.disabled\"\n        :class=\"`${DRILL_DOWN_PRE_CLASS}-menu-item`\"\n      >\n        <template #icon>\n          <TextIcon v-if=\"option.type === 'text'\" />\n          <CalendarIcon v-if=\"option.type === 'date'\" />\n          <LocationIcon v-if=\"option.type === 'location'\" />\n        </template>\n        {{ option?.name }}\n      </MenuItem>\n    </Menu>\n  </div>\n</template>\n\n<style lang=\"less\" scoped>\n@import '@antv/s2/esm/shared/styles/drill-down.less';\n</style>\n"],"names":["_resolveComponent","_normalizeClass","title","_createElementVNode","_toDisplayString","_createVNode","handleClear","handleSearch","isEmpty","options","_openBlock","_createBlock","_createCommentVNode","handleSelect","_createElementBlock","_Fragment","_renderList","_withCtx"],"mappings":";;;;;;;;;;;;0BA2GEA,iBAsCM,MAAA;;IArCJ,OAAAC,eAKS,CAAA,KAAA,sBAAA,KAAA,SAAA,CAAA;AAAA,EAAA,GAAA;AAAA;MAJP,OAAAA,eAAsB,4BAAdC,SAAK;AAAA,IAAA,GACb;AAAA,MAAAC,mBAAmB,OAAA,MAAAC,gBAAA,KAAA,KAAA,GAAA,CAAA;AAAA,MAAAC,YAASC,mBAAW;AAAA,QAAA,MAAA;AAAA;;;;;;SAIzC,GAAA,CAAA,SAME,CAAA;AAAA,IAAA,GALC,CAAA;AAAA,IAAAD,YACW,kBAAY;AAAA,MACvB,sBAAQE,GAAAA,KAAY,oBAAA,SAAA;AAAA,MACpB,aAAU,KAAEA;AAAAA,MACZ,UAAU,KAAE;AAAA,MAAA,cAAA,KAAA;AAAA,MAGPC,YAAQC;AAAAA,IAAAA,GAAAA,MAAAA,GAAAA,CAAAA,SADhB,eAIE,YAAA,cAAA,CAAA;AAAA,IAAA,KAAA,QAAA,KAAA,OAAA,KAAAC,UAAA,GAFaC,YAAA,kBAAkB;AAAA,MAC9B,KAAK;AAAA,MAAA,YAAA,EAAA,QAAA,OAAA;AAAA;IAER,GAAA,MAkBO,iBAjBLC,mBAAM,IAAA,IAAA;AAAA,IAAAP,YACE,iBAAsB;AAAA,MAAA,OAAA;AAAA,MAC7B,cAAQQ,KAAAA;AAAAA,MAAAA,yBAAAA,OAAAA,CAAAA,MAAAA,OAAAA,CAAAA,IAAAA,CAAAA,WAAAA,KAAAA,WAAAA;AAAAA;;;SAIDH,UAAA,IAAO,GAAAI,mBAAKC,UAAA,MAAAC,WAAA,KAAA,SAAA,CAAA,WAAA;AACjB,iBAAAN,UAAA,GAAiBC,YAAQ,qBAAA;AAAA,YACzB,KAAK,OAAA;AAAA,YAAA,UAAA,OAAA;AAAA,YAEK,OAAIV,eAC6B,GAAA,KAAA,oBAAA,YAAA;AAAA,UAAA,GAAA;AAAA,YAA1C,MAAAgB,QAAA,MAAA;AAAA,cAAA,OAAA,SAAA,UACoBP,UAAA,sEAApB,IAAA,IAA8C;AAAA,cAAA,OAAA,SAAA,UAC1BA,UAAA,0EAApB,IAAA,IAAkD;AAAA,cAAA,OAAA,SAAA,cAAAA,UAAA,GAAAC,YAAA,yBAAA,EAAA,KAAA,EAAA,CAAA,KAAAC,mBAEpD,IAAA,IAAA;AAAA,YAAA,CAAA;AAAA;;;;;;;;;;;;"}