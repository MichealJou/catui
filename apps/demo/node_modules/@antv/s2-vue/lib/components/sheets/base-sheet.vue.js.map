{"version":3,"file":"base-sheet.vue.js","sources":["../../../src/components/sheets/base-sheet.vue"],"sourcesContent":["<script lang=\"ts\">\nimport { S2_PREFIX_CLS } from '@antv/s2';\nimport { Spin } from 'ant-design-vue';\nimport { computed, defineComponent } from 'vue';\nimport { isBoolean } from 'lodash';\nimport S2Pagination from '../pagination/index.vue';\nimport { provideSpreadSheet } from '../../context/SpreadSheetContext';\nimport { useSpreadSheet } from '../../hooks/useSpreadSheet';\nimport {\n  initBaseSheetEmits,\n  initBaseSheetProps,\n} from '../../utils/initPropAndEmits';\n\nexport default defineComponent({\n  name: 'BaseSheet',\n  props: initBaseSheetProps(),\n  emits: initBaseSheetEmits(),\n  setup(props, ctx) {\n    const { wrapperRef, containerRef, s2Ref, loading, pagination } =\n      useSpreadSheet(props, ctx.emit);\n\n    // Provide S2 instance to child components (for DragCopyPoint, etc.)\n    const s2RefComputed = computed(() => s2Ref.value ?? null);\n\n    provideSpreadSheet(s2RefComputed);\n\n    ctx.expose({\n      get instance() {\n        return s2Ref.value;\n      },\n    });\n\n    const handlePageChange = (nextCurrent: number) => {\n      if (props.showPagination && !isBoolean(props.showPagination)) {\n        props.showPagination.onChange?.(nextCurrent);\n      }\n\n      pagination.change(nextCurrent);\n    };\n\n    const handlePageSizeChange = (nextSize: number) => {\n      if (props.showPagination && !isBoolean(props.showPagination)) {\n        props.showPagination.onShowSizeChange?.(nextSize);\n      }\n\n      pagination.showSizeChange(nextSize);\n    };\n\n    return {\n      S2_PREFIX_CLS,\n      wrapperRef,\n      containerRef,\n      s2Ref,\n      loading,\n      pagination,\n      handlePageChange,\n      handlePageSizeChange,\n    };\n  },\n  components: {\n    Spin,\n    S2Pagination,\n  },\n});\n</script>\n\n<template>\n  <Spin :wrapperClassName=\"S2_PREFIX_CLS + '-spin'\" :spinning=\"loading\">\n    <div ref=\"wrapperRef\" :class=\"S2_PREFIX_CLS + '-wrapper'\">\n      <div ref=\"containerRef\" :class=\"S2_PREFIX_CLS + '-container'\" />\n      <S2Pagination\n        v-if=\"pagination.visible.value\"\n        :current=\"pagination.current.value\"\n        :pageSize=\"pagination.pageSize.value\"\n        :total=\"pagination.total.value\"\n        :customOptions=\"pagination.customOptions\"\n        @change=\"handlePageChange\"\n        @showSizeChange=\"handlePageSizeChange\"\n      />\n      <slot name=\"editCell\" />\n    </div>\n  </Spin>\n</template>\n\n<style lang=\"less\">\n@import '@antv/s2/esm/shared/styles/variables.less';\n\n.@{s2-cls-prefix} {\n  &-spin.ant-spin-nested-loading,\n  &-spin > .ant-spin-container {\n    height: 100%;\n  }\n\n  &-wrapper {\n    padding: 0;\n    margin: 0;\n    display: flex;\n    flex-direction: column;\n    height: 100%;\n  }\n\n  &-container {\n    overflow: auto;\n    flex: 1 1 auto;\n\n    canvas {\n      display: block;\n    }\n  }\n\n  &-pagination {\n    display: flex;\n    align-items: center;\n    z-index: 1024;\n\n    &-count {\n      margin-left: 12px;\n      text-overflow: ellipsis;\n      white-space: nowrap;\n      max-width: 64px;\n    }\n  }\n}\n</style>\n"],"names":["_resolveComponent","_openBlock","loading","_withCtx","_createElementVNode","S2_PREFIX_CLS","_normalizeClass","pagination","handlePageChange","handlePageSizeChange","_createCommentVNode"],"mappings":";;;;;;;0BAmEEA,IAAAA,iBAcO,MAAA;AAd4C,SAAAC,IAAAA,UAAA,GAAUC,IAAAA,YAAO,iBAAA;AAAA,IAAA,kBAAA,KAAA,gBAAA;AAAA;;aACzDC,IAAAA,QAAA,MAAY;AAAA,MAAAC,IAAAA,mBAAO,OAAEC;AAAAA,QAAAA,KAAAA;AAAAA,QAC5B,OAAAC,IAAAA,eAAgE,KAAA,gBAAA,UAAA;AAAA,MAAA,GAAA;AAAA,+BAAlC,OAAED;AAAAA,UAAAA,KAAAA;AAAAA,UAExBE,OAAAA,IAAAA,eAAmB,KAAK,gBAAA,YAAA;AAAA,QAAA,GAAA,MAAA,CAAA;AAAA,QACpBA,KAAAA,WAAAA,QAAAA,SAAAA,IAAAA,UAAAA,GAAAA,IAAAA,YAAW,yBAAa;AAAA,UACjC,KAAA;AAAA,UACA,SAAOA,gBAAW,QAAM;AAAA,UACxB,eAAeA,WAAAA,SAAW;AAAA,UAC1B,OAAA,KAAQC,WAAAA,MAAAA;AAAAA,UACR,eAAA,KAAgBC,WAAAA;AAAAA,UAAAA,UAAAA,KAAAA;AAAAA;WAEnB,MAAwB,GAAA,CAAA,WAAA,YAAA,SAAA,iBAAA,YAAA,kBAAA,CAAA,KAAAC,IAAAA,mBAAA,IAAA,IAAA;AAAA;;;;;;;;"}